#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdint.h>

#define N_THREAD 5

pthread_barrier_t barrier_thread;
pthread_t threads[N_THREAD];

void *thread(void *num_thread) {
    int random_time = rand() % 10;
    sleep(random_time);
    printf("[thread %ld] Point atteint\n", (long)num_thread);
    pthread_barrier_wait(&barrier_thread);
    printf("[thread %ld] Je continue\n", (long)num_thread);
    return NULL;
}

int main() {
    int i;
    srand(time(NULL));
    pthread_barrier_init(&barrier_thread, NULL, N_THREAD);
    for (i = 1; i <= N_THREAD; i++) {
        pthread_create(&threads[i-1], NULL, thread, (void *)(intptr_t)i);
    }
    for (i = 0; i < N_THREAD; i++) {
        pthread_join(threads[i], NULL);
    }
    pthread_barrier_destroy(&barrier_thread);
    return 0;
}