#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

#define N 10

char tampon[N];
int indice_ecriture = 0;
int indice_lecture = 0;

// Fonction pour écrire dans le tampon
void ecrire_tampon(char data) {
    tampon[indice_ecriture] = data;
    indice_ecriture = (indice_ecriture + 1) % N;
}

// Fonction pour lire dans le tampon
char lecture_tampon() {
    char data = tampon[indice_lecture];
    tampon[indice_lecture] = '\0';
    indice_lecture = (indice_lecture + 1) % N;
    return data;
}

// Fonction pour le thread d'écriture
void *ecrivain(void *arg) {
    char data;
    while (1) {
        printf("Entrez une donnée à écrire dans le tampon : ");
        scanf(" %c", &data);
        ecrire_tampon(data);
    }
    pthread_exit(NULL);
}

// Fonction pour le thread de lecture
void *lecteur(void *arg) {
    char data;
    while (1) {
        data = lecture_tampon();
        printf("Donnée lue : %c\n", data);
    }
    pthread_exit(NULL);
}

int main() {
    pthread_t thread_ecrivain, thread_lecteur;
    pthread_create(&thread_ecrivain, NULL, ecrivain, NULL);
    pthread_create(&thread_lecteur, NULL, lecteur, NULL);
    pthread_join(thread_ecrivain, NULL);
    pthread_join(thread_lecteur, NULL);
    return 0;
}

#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

#define N 10

char tampon[N];
int indice_ecriture = 0;
int indice_lecture = 0;
int nb_elements = 0;

pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;
pthread_cond_t cond_ecriture = PTHREAD_COND_INITIALIZER;
pthread_cond_t cond_lecture = PTHREAD_COND_INITIALIZER;

// Fonction pour écrire dans le tampon
void ecrire_tampon(char data) {
    pthread_mutex_lock(&mutex);
    while (nb_elements == N) {
        pthread_cond_wait(&cond_ecriture, &mutex);
    }
    tampon[indice_ecriture] = data;
    indice_ecriture = (indice_ecriture + 1) % N;
    nb_elements++;
    pthread_cond_signal(&cond_lecture);
    pthread_mutex_unlock(&mutex);
}

// Fonction pour lire dans le tampon
char lecture_tampon() {
    pthread_mutex_lock(&mutex);
    while (nb_elements == 0) {
        pthread_cond_wait(&cond_lecture, &mutex);
    }
    char data = tampon[indice_lecture];
    tampon[indice_lecture] = '\0';
    indice_lecture = (indice_lecture + 1) % N;
    nb_elements--;
    pthread_cond_signal(&cond_ecriture);
    pthread_mutex_unlock(&mutex);
    return data;
}

// Fonction pour le thread d'écriture
void *ecrivain(void *arg) {
    char data;
    while (1) {
        printf("Entrez une donnée à écrire dans le tampon : ");
        scanf(" %c", &data);
        ecrire_tampon(data);
    }
    pthread_exit(NULL);
}

// Fonction pour le thread de lecture
void *lecteur(void *arg) {
    char data;
    while (1) {
        data = lecture_tampon();
        printf("Donnée lue : %c\n", data);
    }
    pthread_exit(NULL);
}

int main() {
    pthread_t thread_ecrivain, thread_lecteur;
    pthread_create(&thread_ecrivain, NULL, ecrivain, NULL);
    pthread_create(&thread_lecteur, NULL, lecteur, NULL);
    pthread_join(thread_ecrivain, NULL);
    pthread_join(thread_lecteur, NULL);
    return 0;
}